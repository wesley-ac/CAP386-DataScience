---
title: "Exercício 03 - 07/07/2017"
output: github_document
---

### 1)The	“hotdog” variable for	the	“Hot	Dogs	in	Baltimore”	example	can	be	better	defined.

#### R.)Existem duas possibilidades, a primeira seria incluir todas as possíveis combinações de maiuscula e minuscula de Hot Dog que existem, e a outra seria utilizar o 'ignore.case = TRUE' 
Caso 1
```{r}
grepl("[Hot dog|Hot Dog|Hot Dogs|Hot dogs]",bVendors$ItemsSold)

```

```{r}
grepl("[Hot dog|Hot Dogs]",bVendors$ItemsSold,ignore.case = TRUE)

```

### 2) I	prefer	Pizza. Create	a	“pizza”	variable	then
####R.)

```{r}

grepl("Pizza",bVendors$ItemsSold,ignore.case = TRUE)


```

### 3) Get	the	name	of	the	town	for	the	“Hot	Dogs	in	Baltimore”.
#### R.)


```{r}
Teste = bVendors

Teste$TownZ = do.call(rbind,strsplit(Teste$location,"\n"))[,1]
Teste$Town = strtrim(Teste$Town,nchar(Teste$Town)-6)
Teste$TownZ = NULL
head(Teste$Town)

```

### 4)Complete	the	Codebook	for	the	“Hot	Dogs	in	Baltimore”	example.

1° - Importando os dados de entrada

```{r}
#Armazenando a URL em uma variavel 
site = "https://data.baltimorecity.gov/api/views/bqw3-z52q/rows.csv?accessType=DOWNLOAD"

#Baixa o arquivo e salva na pasta "TempData" com o nome Bfood.csv
#Realiza um teste para ver se já existe um arquivo 
if (file.exists("./TempData/BFood.csv")) 
  {
  tam = file.info("./TempData/BFood.csv")$size # armazena o tamnho do arquivo
  cdata = file.info("./TempData/BFood.csv")$ctime #armazena a data de criação
  paste("Arquivo já existe. ",tam,"bytes. Criado em:",cdata)
  } else
  {
    download.file(site,destfile = "./TempData/BFood.csv",method="curl")
    "Arquivo baixado com sucesso!"
  }

bVendors <- read.csv(file="./TempData/BFood.csv", header=TRUE, sep=",", stringsAsFactors=FALSE)

str(bVendors) # Mostra um pedaço do arquivo importado
```

2 - Linpando Dados Vazios e desnecessários. Renomeando Colunas
```{r}
#Excluindo os dados de ID e ST
bVendors$Id = NULL
bVendors$St = NULL

#Renomeando a coluna Location1
names(bVendors)[names(bVendors) == "Location.1"] <- "location"

```

3 - Organizando os dados de Localização

```{r}
##Dividindo a coluna de Localização em 4 partes, Town, ZipCode, Lat e Long
# A primeira divisão é quebrar a coluna Location pelo separador '\n' e guardar a primeira parte
Teste$TownZ = do.call(rbind,strsplit(Teste$location,"\n"))[,1]

#Retirar da string resultante o nome da Cidade (neste caso foi eliminado os 5 ultimos caracteres referente ao ZIP code)
Teste$Town = strtrim(Teste$TownZ,nchar(Teste$Town)-6)

# Retirar da primeira parta da string location o ZIPcode (os últimos 5 caracteres)
Teste$ZIP = substring(Teste$TownZ,nchar(Teste$Town)-4,nchar(Teste$Town))

# Os dados de LAT LONG estão dentro de '()'. Assim foi necessário retirar esses caracteres da segunda parte do string
Teste$LatLong = do.call(rbind,strsplit(Teste$location,"\n"))[,2]
Teste$LatLong = gsub("\\(|)","",Teste$LatLong)

# Dividiu a coluna de LatLong pelo separador ',' obtendo os resultados de LAT e LONG em colunas individuaizadas
Teste$Lat = as.numeric(do.call(rbind,strsplit(Teste$LatLong,","))[,1])
Teste$Long = as.numeric(do.call(rbind,strsplit(Teste$LatLong,","))[,2])


```
